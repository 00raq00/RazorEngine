<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFrameworks>net462;netcoreapp2.0</TargetFrameworks>
    <DefineConstants>$(DefineConstants);NET45;RAZOR4;</DefineConstants>
    <!-- TODO: Move this between Lines 12-14.
    These should be under a property group just for .NET Core App 2.0.
    This is here to ensure that the behaviour in .NET 4.6.2 and .NET Core App 2.0 are the same.
    -->
    <DefineConstants>$(DefineConstants);NO_APPDOMAIN;NO_REMOTING;NO_CODEDOM;NO_CONFIGURATION;NETCORE</DefineConstants>
    <DisableImplicitFrameworkReferences>true</DisableImplicitFrameworkReferences>
  </PropertyGroup>
  <PropertyGroup Condition="'$(TargetFramework)' == 'netcoreapp2.0'">
    <OutputType>Exe</OutputType>
  </PropertyGroup>
  <PropertyGroup>
    <!-- Do not generate AssemblyInfo because we are doing that with the
      GenerateAssemblyInfoFile target in dir.targets -->
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
  </PropertyGroup>
  <PropertyGroup>
    <AssemblyOriginatorKeyFile>RazorEngine.snk</AssemblyOriginatorKeyFile>
    <SignAssembly>true</SignAssembly>
    <RootNamespace>Test.RazorEngine</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <PackageReference Include="Autofac" Version="4.6.0" />
    <PackageReference Include="Microsoft.CSharp" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="15.3.0-preview-20170618-03" />
    <PackageReference Include="Moq" Version="4.7.63" />
    <PackageReference Include="NUnit" Version="3.7.1" />
    <PackageReference Include="NUnit3TestAdapter" Version="3.8.0-alpha1" />
    <PackageReference Include="System.Diagnostics.Contracts" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Dynamic.Runtime" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Globalization" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.IO.FileSystem.Primitives" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.IO.FileSystem.Watcher" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Linq.Expressions" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Net.Primitives" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Reflection.Emit" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Reflection.Emit.ILGeneration" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Runtime" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Runtime.Handles" Version="4.4.0-beta-24913-02" />
    <PackageReference Include="System.Security.Permissions" Version="4.4.0-beta-24913-02" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\source\RazorEngine.Core.Roslyn\RazorEngine.Core.Roslyn.NetCore.csproj" />
    <ProjectReference Include="..\..\source\RazorEngine.Core\RazorEngine.Core.NetCore.csproj" />
  </ItemGroup>
  <ItemGroup Condition="$(DefineConstants.Contains('NO_APPDOMAIN'))">
    <Compile Remove="IsolatedRazorEngineServiceTestFixture.cs" />
    <Compile Remove="IsolatedTemplateServiceTestFixture.cs" />
    <Compile Remove="RazorEngineCleanupTests.cs" />
  </ItemGroup>
  <ItemGroup Condition="$(DefineConstants.Contains('NO_CODEDOM'))">
    <Compile Remove="TemplateServiceTestFixture.cs" />
  </ItemGroup>
  <ItemGroup Condition="$(DefineConstants.Contains('NO_CONFIGURATION'))">
    <Compile Remove="ConfigurationTestFixture.cs" />
  </ItemGroup>

  <ItemGroup>
    <Compile Remove="ActivatorTestFixture.cs" />
    <Compile Remove="TestTypes\Activation\UnityTemplateActivator.cs" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Include="Templating\Templates\Layout.cshtml" />
    <EmbeddedResource Include="Templating\Templates\NoModel.cshtml" />
    <EmbeddedResource Include="Templating\Templates\Partial.cshtml" />
    <EmbeddedResource Include="Templating\Templates\WithLayout.cshtml" />
    <EmbeddedResource Include="Templating\Templates\WithModel.cshtml" />
    <EmbeddedResource Include="Templating\Templates\WithPartial.cshtml" />
    <None Include="test\TestHelper.dll">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
  </ItemGroup>
</Project>
